=== Link Library ===
Contributors: jackdewey
Donate link: http://ylefebvre.ca/wordpress-plugins/link-library
Tags: link, list, directory, page, library, AJAX, RSS, feeds, inline, search, paging, add, submit, import, batch, pop-up
Requires at least: 3.0
Tested up to: 3.9.1
Stable tag: trunk

The purpose of this plugin is to add the ability to output a list of link categories and a complete list of links with notes and descriptions.

== Description ==

This plugin is used to be able to create a page on your web site that will contain a list of all of the link categories that you have defined inside of the Links section of the Wordpress administration, along with all links defined in these categories. The user can select a sub-set of categories to be displayed or not displayed. Link Library also offers a mode where only one category is shown at a time, using AJAX or HTML Get queries to load other categories based on user input. It can display a search box and find results based on queries. It can also display a form to accept user submissions and allow the site administrator to moderate them before listing the new entries. Finally, it can generate an RSS feed for your link collection so that people can be aware of additions to your link library.

For links that carry RSS feed information, Link Library can display a preview of the latest feed items inline with the all links or in a separate preview window.

This plugin uses the filter method to add contents to the pages. It also contains a configuration page under the admin tools to be able to configure all outputs. This page allows for an unlimited number of different configurations to be created to display links on different pages of a Wordpress site.

You can see a few examples of pages using Link Library on my personal site:

* [Library in table form with search box and link submission form](http://yannickcorner.nayanna.biz/freeware-database/)
* [Library in unordered list form with RSS feed icons](http://yannickcorner.nayanna.biz/favorite-links/)
* [Library in unordered list form with RSS feed icons and Pagination](http://yannickcorner.nayanna.biz/links-page-with-pagination/)
* [Library only showing one category at a time through AJAX queries](http://yannickcorner.nayanna.biz/freeware-database-ajax-version/)
* [Library in unordered list form with 1 full RSS item per feed inline and 5 RSS item full previews when selecting preview icon](http://yannickcorner.nayanna.biz/links-page-with-preview/)
* [RSS Feed generated by Link Library for Freeware Database](http://yannickcorner.nayanna.biz/wp-content/plugins/link-library/rssfeed.php?settingset=1)

For screenshots showing how to achieve these results, check out my [site](http://yannickcorner.nayanna.biz/wordpress-plugins/link-library)

Examples from actual users can be found on my [site](http://yannickcorner.nayanna.biz/wordpress-plugins/link-library/link-library-usage-examples/).

All pages are generated using different configurations all managed by Link Library. Link Library is compatible with the [My Link Order](http://wordpress.org/extend/plugins/my-link-order/) plugin to define category and link ordering.

* [Changelog](http://wordpress.org/extend/plugins/link-library/other_notes/)
* [Support Forum](http://wordpress.org/tags/link-library)

== Installation ==

1. Download the plugin
1. Upload link-library.php to the /wp-content/plugins/ directory
1. Activate the plugin in the Wordpress Admin

To get a basic Link Library list showing on one of your Wordpress pages:<br />
1. In the Wordpress Admin, create a new page and type the following text, where # should be replaced by the Settings Set number:<br />
   [link-library settings=#]
   
1. To add a list of categories to jump to a certain point in the list, add the following text to your page:<br />
   [link-library-cats settings=#]<br />
   
1. To add a search box to your Link Library list, add the following text to your page:<br />
   [link-library-search]
   
1. To add a form for users to be able to submit new links:<br />
   [link-library-addlink settings=#]
   
In addition to specifying a library, categories to be displayed can be specified using addition keywords. Read the FAQ for more information on this topic.
   
Further configuration is available under the Link Library Settings panel.

== Changelog ==

= 5.8.5.4 =
* Changed layout of delete and reset buttons to make them more obvious to use
* Fixed late refresh after deleting or resetting options

= 5.8.5.3 =
* Fix link updated date setting to use blog time instead of GMT time
* Corrected issue with RSS feed URL generation

= 5.8.5.2 =
* Fix problem with user-submitted categories on link submission

= 5.8.5.1 =
* Reverted all new functions from 5.8.5 until further testing can be done to resolve layout with new version

= 5.8.4.3 =
* Fixed problem with category links when paginating results

= 5.8.4.2 =
* Fix problem with link counts when displaying category list

= 5.8.4.1 =
* Added hack to allow people to page through links by adding parameters to the end of the link manager URL (?linksperpage=1&linkspage=2)

= 5.8.4 =
* Updated admin menu look

= 5.8.3.2 =
* Second fix to allow searches to work with apostrophes
* Fix to allow categories containing no links to be displayed

= 5.8.3.1 =
* Allow link searches to work with apostrophes
* Fix issue with duplicate images appearing

= 5.8.3 =
* Added entry to stylesheet template to style featured links
* Added new option to use local images attached to link if they are present when thumbshots automatic thumbnail generation is active
* Restores support for versions before 3.5 that did not have the media uploader

= 5.8.2.9 =
* Fixed bug with links and settings export functionality

= 5.8.2.8 =
* Fixed problem with AJAX mode when configured not to show library at first. Library was still showing if empty.
* Link dates can now be formatted and translated to local site language
* Changed links and settings export folder to site upload folder instead of plugin folder

= 5.8.2.7 =
* Added option to hide donation links and Support the Author ad
* Added ability for link updated date to be translated to site language
* Updated french translation

= 5.8.2.6 =
* Increased execution time when importing links to allow for larger imports
* Enhanced media uploader selection to show image right away when no previous image was present

= 5.8.2.5 =
* Fixed bug with Link popup option, which was not creating link with correct URL

= 5.8.2.4 =
* Added option to suppress Link Library footer in notification e-mails

= 5.8.2.3 =
* Fixes bug with search results appearing in ajax mode when hiding links on first page display

= 5.8.2.2 =
* Fixed additional PHP warning

= 5.8.2.1 =
* Fixed PHP warnings

= 5.8.2 =
* Fix compatibility issue with WordPress 3.9

= 5.8.1.3 =
* Fix additional problems found with pagination mode

= 5.8.1.2 =
* Fixed problem with AJAX and Pagination mode both active at the same. Pages other then 1 in a category would not display

= 5.8.1.1 =
* Fixed RSS Preview functionality that had been broken in 5.8.1 update

= 5.8.1 =
* Addressed security concerns raised by Wordpress.org plugin maintenance team

= 5.8.0.9 =
* Added option to display pagination selector before or after links

= 5.8.0.7 =
* Corrected problem with user link submissions introduced by previous update

= 5.8.0.6 =
* Updated french translation
* Added support for media upload to attach new images to links

= 5.8.0.5 =
* Fixed link moderation page to show links submitted by bots with no category

= 5.8.0.4 =
* Added option to display link name or description in link title tag

= 5.8.0.3 =
* Added debug code in moderation section to help troubleshoot issues

= 5.8.0.2 =
* Small styling change in admin interface to adjust to removal of background image in WP 3.6

= 5.8.0.1 =
* Corrected redirection bug when user submitted link with bad field, then corrected and re-submitted

= 5.8 =
* Added new Export All Links button to download all links and their associated data in a CSV format

= 5.7.9.7 =
* Fixed issue for search to now be able to accept non-alphabetic characters

= 5.7.9.6 =
* Fixed issue with disappearing category names

= 5.7.9.5 =
* Allow images to be associated to links when they are first created instead of only when you edit them later

= 5.7.9.4 =
* Fixed bug with large description field not getting saved when users submit links

= 5.7.9.3 =
* Corrected undefined method errors when users submitted new links

= 5.7.9.2 =
* Fixed wp_set_link_cat error when user submission option is active
* Fixed problem with links extra info table not getting created in new installations

= 5.7.9.1 =
* Fixed javascript error on add new link page

= 5.7.9 =
* Fix for error submitting links in 5.7.8

= 5.7.8 =
* Fixed error with unknown column when selecting List Featured Links ahead of Regular Links options

= 5.7.7 =
* Cleanup to avoid PHP warnings when some variables don't exist
* Support for plugin being located in a non-standard location
* Addition on uninstall scripts to delete extra table and settings on plugin deletion
* Thanks to Juliette Reinders Folmer for identifying all these issues
* Split code from admin in separate file to improve load times

= 5.7.6 =
* Added option in general settings to select if images that are uploaded or generated should be stored using their full path (functionality in 5.7.3 or older) or relative paths

= 5.7.5 =
* Fixed issue around category name div tags in list

= 5.7.4 =
* Changed stored URL for uploaded images to use relative paths

= 5.7.3 =
* Fixed bug in on-demand thumbnail generation

= 5.7.2 =
* Added div around Thumbshots notice to allow paying users to hide notice (free users need to keep notice displayed to avoid being banned by service)

= 5.7.1 =
* Fixed issue with Thumbshots CID having non-url compliant characters

= 5.7 =
* Re-worked Thumbshots integration to comply with new terms of use
* Updated french translation

= 5.6.9 =
* Added option to load styling on all pages with keyword 'all'

= 5.6.8 =
* Corrected error from version 5.6.7

= 5.6.7 =
* Added option to load styling on category pages with keyword 'category'

= 5.6.6 =
* Added option to load styling on front page with keyword 'front'

= 5.6.5 =
* Adds a div class to category names for styling

= 5.6.4 =
* Added new option so that no category is shown in AJAX mode until the visitor selects a category

= 5.6.3 =
* Re-implemented changes from version 5.6.1

= 5.6.2 =
* Rolled back changes

= 5.6.1 =
* Corrected problem with two undefined variables

= 5.6 =
* Added count of links to moderate in top-level Link Library menu item
* Added dashboard widget to display count of links to moderate

= 5.5.9.1 =
* Changed WP 3.5 support code to force presence of Link Manager if Link Library is installed and activated

= 5.5.9 =
* Removed check for presence of Link Manager in versions older than 3.5

= 5.5.8 =
* Added check for presence of Link Manager to support version 3.5 where the link manager will be inactive by default

= 5.5.7 =
* Added codes in pop-up content to display link rating and rss link

= 5.5.6 =
* Fixed link visit tracking code

= 5.5.5 =
* Added codes in pop-up content to display link submitter, link alternate URL and number of visits

= 5.5.4 =
* Attached popup to image and link name instead of only link name, when configured

= 5.5.3 =
* Added code in pop-up content to display link description, link large description, telephone number and e-mail
* Added pop-up configuration options to specify width and height

= 5.5.2 =
* Updated link popup mechanism to use link target information

= 5.5.1 =
* Added support to convert [ and ] to < and > in large description fields

= 5.5 =
* Added new option to display a popup with user-defined content when links are clicked, then present user with link to click through
* Updated danish translation

= 5.4.9.5 =
* Fixed problem with category links not going to the correct results page when pagination is turned on

= 5.4.9.4 =
* Fixed problem with nofollow and featured item check boxed not unchecking properly

= 5.4.9.3 =
* Fixed problem with e-mail notification when user-submitted links were received

= 5.4.9.2 =
* Correction to bad site admin path in e-mail notification

= 5.4.9.1 =
* Changes method used to build paths to images and other plugin files
* Fixed reciprocal link checker

= 5.4.9 =
* Removed previous affiliate link and added information on my upcoming book.

= 5.4.8 =
* Reverted all changes made in version 5.4.7 to remove undefined variable warnings

= 5.4.7 =
* Fixed undefined variable warnings, which showed up when WP_DEBUG was activated

= 5.4.6 =
* Clearly identified affiliate link in user interface
* Made affiliate image local to plugin

= 5.4.5 =
* Fixed problem with Link ID missing on some installations from links in moderation page

= 5.4.4 =
* Updated danish translation

= 5.4.3 =
* Cleanup to avoid PHP debug warnings

= 5.4.2 =
* Fixed problem with library switching logic

= 5.4.1 =
* Fixed path to plugin icon file

= 5.4 =
* Redesigned user submission processing code to send post data to external php file and redirect back after data storage and validation

= 5.3.3 = 
* Fixed duplicate check on user-submitted links
* Fixed problem with other plugins causing shortcode to be evaluated multiple times, resulting in multiple links submission

= 5.3.2 =
* Updated meta box creation code to be compatible with WordPress 3.3

= 5.3.1 =
* Added option to specify address for search box results. This allow you to place search box on one page and results on another page.
* Updated French translation
* Updated Italian translation
* Added Turkish translation

= 5.3 =
* Fixed way that messages were displayed when using user submission form
* Added error message when submitting a link without an address

= 5.2.9 =
* Updated Italian translation
* Updated French translation
* Added missing translation

= 5.2.8 =
* Updated translation file to add text for new option introduced in 5.2.7

= 5.2.7 =
* Added option to replace image with link name if no image is assigned to a link

= 5.2.6 =
* Added missing translation for UI element

= 5.2.5 =
* Split a sentence in two full pieces to facilitate translation.

= 5.2.4 =
* Fixed glitch with reciprocal check menu item disappearing

= 5.2.3 =
* Added italian translation (Thanks to Gianni Diurno!)
* Fixed some text strings which could not be translated

= 5.2.2 =
* Added check for search parameters to verify that they are only text or numbers

= 5.2.1 =
* Added an option to display link category list on search results page

= 5.2 =
* Added span tag to link category description to allow for styling

= 5.1.9 =
* Fixed updated date mechanism

= 5.1.8 =
* Removed debug code in link moderation screen
* Fixed problem with empty categories not showing up even if Hide when empty is not checked

= 5.1.7 =
* Fixed problem with category drop-down in user-submission form that prevented it from appearing in some situations
* Added data type validation code to avoid security exploits

= 5.1.6 =
* Corrected problem with link moderation list screen

= 5.1.5 =
* Corrected a problem with new link submission in admin editor

= 5.1.4 =
* Removed extra debugging code

= 5.1.3 =
* Added new sort mode to display links based on updated date
* Added field to links editor to see updated date and be able to manually change it

= 5.1.2 =
* Changed RSS parsing library back to Simplepie, but using version supplied with Wordpress with extra layer

= 5.1.1 =
* Corrected plugin installation function to properly create custom tables in multi-site environment
* Replaced SimplePie with PHP_RSS library to avoid PHP5 validation errors and have simpler code base

= 5.1.0 =
* Correct path for RSS Icon and RSS Preview Icons

= 5.0.9 =
* Security fix

= 5.0.8 =
* Fixed RSS Feed generation code to accept https links

= 5.0.7 =
* Added details on use of catogory list in link submission form
* Now using Moderator E-mail (if present) as destination address for moderation notifications

= 5.0.6 =
* Fixed problem with path of images uploaded for links

= 5.0.5 =
* Added option in reciprocal checker to delete links that return a 403 error during check

= 5.0.4 =
* Made code change to always load jQuery as soon as Link Library is rendered on a site to enable link click tracking
= 5.0.3 =
* Changed link id field to contain text before their numeric ID to be xhtml compliant
* Added code to strip slashes on custom fields in link editor
* Added link category to link moderation screen
* Add option to use textarea instead of input field for link notes in user submission form
* Added check in Reciprocal checked to see if site is dead. Display appropriate message if it is.

= 5.0.2 =
* Corrected a problem where slashes were getting added in front of quote and apostrophes when editing large description
= 5.0.1 =
* Added code to escape special characters in large description field when importing links

= 5.0 =
* Added new mode to show link categories in a drop-down list
* Replaced calls to wp_specialchars with esc_html since the previous function was deprecated in WP 2.8
* Corrected bad CSS styling in admin sections
* Added bookmarklet creation section in admin to allow for quick link creation
* Fixed problem where settings became "sticky" until you went out of plugin admin and came back after resetting them

== Frequently Asked Questions ==

= Where do I find my category IDs to place in the "Categories to be Displayed" and "Categories to be Excluded" fields? =

The category IDs are numeric IDs. You can find them by going to the page to see and edit link categories, then placing your mouse over a category and seeing its numeric ID in the link that is associated with that name.

= How can I display different categories on different pages? =

If you want all of your link pages to have the same layout, create a single setting set, then specify the category to be displayed when you add the short code to each page. For example: [link-library categorylistoverride="28"]
If the different pages have different styles for different categories, then you should create distinct setting sets for each page and set the categories to be displayed in the "Categories to be Displayed" field in the admin panel.

= After assigning a Link Acknowledgement URL, why do links no longer get added to my database? =

When using this option, the short code [link-library-addlinkcustommsg] should be placed on the destination page.

= How can I override some of the options when using shortcodes in my pages =

To override the settings specified inside of the plugin settings page, the two commands can be called with options. Here is the syntax to call these options:

[link-library-cats categorylistoverride="28"]

Overrides the list of categories to be displayed in the category list

[link-library-cats excludecategoryoverride="28"]

Overrides the list of categories to be excluded in the category list

[link-library categorylistoverride="28"]

Overrides the list of categories to be displayed in the link list

[link-library excludecategoryoverride="28"]

Overrides the list of categories to be excluded in the link list

[link-library notesoverride=0]

Set to 0 or 1 to display or not display link notes

[link-library descoverride=0]

Set to 0 or 1 to display or not display link descriptions

[link-library rssoverride=0]

Set to 0 or 1 to display or not display rss information

[link-library tableoverride=0]

Set to 0 or 1 to display links in an unordered list or a table.

= Can Link Library be used as before by calling PHP functions? =

For legacy users of Link Library (pre-1.0), it is still possible to call the back-end functions of the plugin from PHP code to display the contents of your library directly from a page template.

The main differences are that the function names have been changed to reflect the plugin name. However, the parameters are compatible with the previous function, with a few additions having been made. Also, it is important to note that the function does not output the Link Library content by themselves as they did. You now need to print the return value of these functions, which can be simply done with the echo command. Finally, it is possible to call these PHP functions with a single argument ('AdminSettings1', 'AdminSettings2', 'AdminSettings3', 'AdminSettings4' or 'AdminSettings5') so that the settings defined in the Admin section are used.

Here would be the installation procedure:

1. Download the plugin
1. Upload link-library.php to the /wp-content/plugins/ directory
1. Activate the plugin in the Wordpress Admin
1. Use the following functions in a [new template](http://codex.wordpress.org/Pages#Page_Templates) and select this template for your page that should display your Link Library.

`&lt;?php echo $my_link_library_plugin->LinkLibraryCategories('name', 1, 100, 3, 1, 0, '', '', '', false, '', ''); ?&gt;<br />
`&lt;br /&gt;<br />
&lt;?php echo $my_link_library_plugin->LinkLibrary('name', 1, 1, 1, 1, 0, 0, '', 0, 0, 1, 1, '&lt;td>', '&lt;/td&gt;', 1, '', '&lt;tr&gt;', '&lt;/tr&gt;', '&lt;td&gt;', '&lt;/td&gt;', 1, '&lt;td&gt;', '&lt;/td&gt;', 1, "Application", "Description", "Similar to", 1, '', '', '', false, 'linklistcatname', false, 0, null, null, null, false, false, false, false, '', ''); ?&gt;

=function LinkLibraryCategories()=

 Output a list of all links categories, listed by category, using the settings in $wpdb->linkcategories and output it as table

 Parameters:<br/>
   order (default 'name')  - Sort link categories by 'name', 'id', 'catlist'. When set to 'AdminSettings', will use parameters set in Admin Settings Panel.<br/>
   hideifempty (default true)  - Supress listing empty link categories<br/>
   tablewitdh (default 100) - Width of table, percentage<br/>
   numcolumns (default 1) - Number of columns in table<br/>
   catanchor (default false) - Determines if links to generated anchors should be created<br/>
   flatlist (default false) - When set to true, displays an unordered list instead of a table<br/>
   categorylist (default null) - Specifies a comma-separate list of the only categories that should be displayed<br/>
   excludecategorylist (default null) - Specifies a comma-separate list of the categories that should not be displayed<br/>
   showcategorydescheaders (default null) - Show category descriptions in category list<br/>
   showonecatonly (default false) - Enable AJAX mode showing only one category at a time<br/>
   settings (default NULL) - Settings Set ID, only used when showonecatonly is true<br/>
   loadingicon (default NULL) - Path to icon to display when only show one category at a time<br/>

=function LinkLibrary()=

 Output a list of all links, listed by category, using the settings in $wpdb->linkcategories and output it as a nested HTML unordered list. Can also insert anchors for categories

 Parameters:<br/>
   order (default 'name')  - Sort link categories by 'name', 'id' or 'catlist'. When set to 'AdminSettings', will use parameters set in Admin Settings Panel.<br/>
   hideifempty (default true)  - Supress listing empty link categories<br/>
   catanchor (default false) - Adds name anchors to categorie links to be able to link directly to categories<br/>
   showdescription (default false) - Displays link descriptions. Added for 2.1 since link categories no longer have this setting<br/>
   shownotes (default false) - Shows notes in addition to description for links (useful since notes field is larger than description)<br/>
   showrating (default false) - Displays link ratings. Added for 2.1 since link categories no longer have this setting<br/>
   showupdated (default false) - Displays link updated date. Added for 2.1 since link categories no longer have this setting<br/>
   categorylist (default null) - Only show links inside of selected categories. Enter category numbers in a string separated by commas<br/>
   showimages (default false) - Displays link images. Added for 2.1 since link categories no longer have this setting<br/>
   showimageandname (default false) - Show both image and name instead of only one or the other<br/>
   usehtmltags (default false) - Use HTML tags for formatting instead of just displaying them<br/>
   showrss (default false) - Display RSS URI if available in link description<br/>
   beforenote (default &lt;br /&gt;) - Code to print out between the description and notes<br/>
   nofollow (default false) - Adds nofollow tag to outgoing links<br/>
   excludecategorylist (default null) - Specifies a comma-separate list of the categories that should not be displayed<br/>
   afternote (default null) - Code / Text to be displayed after note<br/>
   beforeitem (default null) - Code / Text to be displayed before item<br/>
   afteritem (default null) - Code / Text to be displayed after item<br/>
   beforedesc (default null) - Code / Text to be displayed before description<br/>
   afterdesc (default null) - Code / Text to be displayed after description<br/>
   displayastable (default false) - Display lists of links as a table (when true) or as an unordered list (when false)<br/>
   beforelink (default null) - Code / Text to be displayed before link<br/>
   afterlink (default null) - Code / Text to be displayed after link<br/>
   showcolumnheaders (default false) - Show column headers if rendering in table mode<br/>
   linkheader (default null) - Text to be shown in link column when displaying as table<br/>
   descheader (default null) - Text to be shown in desc column when displaying as table<br/>
   notesheader (default null) - Text to be shown in notes column when displaying as table<br/>
   catlistwrappers (default 1) - Number of different sets of alternating elements to be placed before and after each link category section<br/>
   beforecatlist1 (default null) - First element to be placed before a link category section<br/>
   beforecatlist2 (default null) - Second element to be placed before a link category section<br/>
   beforecatlist3 (default null) - Third element to be placed before a link category section<br/>
   divorheader (default false) - Output div before and after cat name if false, output heading tag if true<br/>
   catnameoutput (default linklistcatname) - Name of div class or heading to output<br/>   
   showrssicon (default false) - Output RSS URI if available and assign to standard RSS icon<br />
   linkaddfrequency (default 0) - Frequency at which extra before and after output should be placed around links<br />
   addbeforelink (default null) - Addition output to be placed before link<br />
   addafterlink (default null) - Addition output to be placed after link<br />
   linktarget (default null) - Specifies the link target window<br />
   showcategorydescheaders (default false) - Display link category description when printing category list<br />
   showcategorydesclinks (default false) - Display link category description when printing links<br />
   showadmineditlinks (default false) - Display edit links in output if logged in as administrator<br />
   showonecatonly (default false) - Only show one category at a time<br />
   AJAXcatid (default null) - Category ID for AJAX sub-queries<br />
   defaultsinglecat (default null) - ID of first category to be shown in single category mode<br />
   rsspreview (default false) - Add preview links after RSS feed addresses<br />
   rssfeedpreviewcount(default 3) - Number of RSS feed items to show in preview<br />
   rssfeedinline (default false) - Shows latest feed items inline with link list<br />
   rssfeedinlinecontent (default false) - Shows latest feed items contents inline with link list<br />
   rssfeedinlinecount (default 1) - Number of RSS feed items to show inline<br />
   beforerss (default null) - String to output before RSS block<br />
   afterrss (default null) - String to output after RSS block<br />


== Screenshots ==

1. The Settings Panel used to configure the output of Link Library
2. A sample output page, displaying a list of categories and the links for all categories in a table form.
2. A second sample output showing a list of links with RSS feed icons and RSS preview link.